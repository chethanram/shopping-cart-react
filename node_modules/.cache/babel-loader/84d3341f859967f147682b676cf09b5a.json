{"ast":null,"code":"import { FETCH_PRODUCTS } from './actionTypes';\nimport axios from 'axios';\nimport { productsAPI } from '../util';\nvar compare = {\n  lowestprice: function lowestprice(a, b) {\n    if (a.price < b.price) return -1;\n    if (a.price > b.price) return 1;\n    return 0;\n  },\n  highestprice: function highestprice(a, b) {\n    if (a.price > b.price) return -1;\n    if (a.price < b.price) return 1;\n    return 0;\n  },\n  discount: function discount(a, b) {\n    if (a.discount > b.discount) return 1;\n    return 0;\n  }\n};\nexport var fetchProducts = function fetchProducts(filters, sortBy, search, callback) {\n  return function (dispatch) {\n    return axios.get(productsAPI).then(function (res) {\n      var products = res.data;\n\n      if (!!filters && filters.length > 0) {\n        products = products.filter(function (p) {\n          return p.price <= filters;\n        });\n      }\n\n      if (!!sortBy) {\n        products = products.sort(compare[sortBy]);\n      }\n\n      if (!!search) {\n        products = products.filter(function (p) {\n          return Object.keys(p).some(function (key) {\n            return p[key].toString().toLowerCase().includes(search.toLowerCase());\n          });\n        });\n      }\n\n      if (!!callback) {\n        callback();\n      }\n\n      return dispatch({\n        type: FETCH_PRODUCTS,\n        payload: products\n      });\n    }).catch(function (err) {\n      console.log('Could not fetch products. Try again later.');\n    });\n  };\n};","map":{"version":3,"sources":["/workspace/shopping-cart-react/src/services/shelf/actions.js"],"names":["FETCH_PRODUCTS","axios","productsAPI","compare","lowestprice","a","b","price","highestprice","discount","fetchProducts","filters","sortBy","search","callback","dispatch","get","then","res","products","data","length","filter","p","sort","Object","keys","some","key","toString","toLowerCase","includes","type","payload","catch","err","console","log"],"mappings":"AAAA,SAASA,cAAT,QAA+B,eAA/B;AACA,OAAOC,KAAP,MAAkB,OAAlB;AAEA,SAASC,WAAT,QAA4B,SAA5B;AAEA,IAAMC,OAAO,GAAG;AACdC,EAAAA,WAAW,EAAE,qBAACC,CAAD,EAAIC,CAAJ,EAAU;AACrB,QAAID,CAAC,CAACE,KAAF,GAAUD,CAAC,CAACC,KAAhB,EAAuB,OAAO,CAAC,CAAR;AACvB,QAAIF,CAAC,CAACE,KAAF,GAAUD,CAAC,CAACC,KAAhB,EAAuB,OAAO,CAAP;AACvB,WAAO,CAAP;AACD,GALa;AAMdC,EAAAA,YAAY,EAAE,sBAACH,CAAD,EAAIC,CAAJ,EAAU;AACtB,QAAID,CAAC,CAACE,KAAF,GAAUD,CAAC,CAACC,KAAhB,EAAuB,OAAO,CAAC,CAAR;AACvB,QAAIF,CAAC,CAACE,KAAF,GAAUD,CAAC,CAACC,KAAhB,EAAuB,OAAO,CAAP;AACvB,WAAO,CAAP;AACD,GAVa;AAWdE,EAAAA,QAAQ,EAAE,kBAACJ,CAAD,EAAGC,CAAH,EAAS;AACjB,QAAID,CAAC,CAACI,QAAF,GAAaH,CAAC,CAACG,QAAnB,EAA6B,OAAO,CAAP;AAC7B,WAAO,CAAP;AACD;AAda,CAAhB;AAiBA,OAAO,IAAMC,aAAa,GAAG,SAAhBA,aAAgB,CAACC,OAAD,EAAUC,MAAV,EAAkBC,MAAlB,EAA0BC,QAA1B;AAAA,SAAuC,UAAAC,QAAQ,EAAI;AAC9E,WAAOd,KAAK,CACTe,GADI,CACAd,WADA,EAEJe,IAFI,CAEC,UAAAC,GAAG,EAAI;AACX,UAAIC,QAAQ,GAAID,GAAG,CAACE,IAApB;;AAEA,UAAI,CAAC,CAACT,OAAF,IAAaA,OAAO,CAACU,MAAR,GAAiB,CAAlC,EAAqC;AACnCF,QAAAA,QAAQ,GAAGA,QAAQ,CAACG,MAAT,CAAgB,UAAAC,CAAC;AAAA,iBAAIA,CAAC,CAAChB,KAAF,IAAWI,OAAf;AAAA,SAAjB,CAAX;AACD;;AAED,UAAI,CAAC,CAACC,MAAN,EAAc;AACZO,QAAAA,QAAQ,GAAGA,QAAQ,CAACK,IAAT,CAAcrB,OAAO,CAACS,MAAD,CAArB,CAAX;AACD;;AAED,UAAG,CAAC,CAACC,MAAL,EAAY;AACVM,QAAAA,QAAQ,GAAGA,QAAQ,CAACG,MAAT,CAAgB,UAAAC,CAAC;AAAA,iBAAIE,MAAM,CAACC,IAAP,CAAYH,CAAZ,EAAeI,IAAf,CAAoB,UAAAC,GAAG;AAAA,mBAAIL,CAAC,CAACK,GAAD,CAAD,CAAOC,QAAP,GAAkBC,WAAlB,GAAgCC,QAAhC,CAAyClB,MAAM,CAACiB,WAAP,EAAzC,CAAJ;AAAA,WAAvB,CAAJ;AAAA,SAAjB,CAAX;AACD;;AAED,UAAI,CAAC,CAAChB,QAAN,EAAgB;AACdA,QAAAA,QAAQ;AACT;;AAED,aAAOC,QAAQ,CAAC;AACdiB,QAAAA,IAAI,EAAEhC,cADQ;AAEdiC,QAAAA,OAAO,EAAEd;AAFK,OAAD,CAAf;AAID,KAzBI,EA0BJe,KA1BI,CA0BE,UAAAC,GAAG,EAAI;AACZC,MAAAA,OAAO,CAACC,GAAR,CAAY,4CAAZ;AACD,KA5BI,CAAP;AA6BD,GA9B4B;AAAA,CAAtB","sourcesContent":["import { FETCH_PRODUCTS } from './actionTypes';\nimport axios from 'axios';\n\nimport { productsAPI } from '../util';\n\nconst compare = {\n  lowestprice: (a, b) => {\n    if (a.price < b.price) return -1;\n    if (a.price > b.price) return 1;\n    return 0;\n  },\n  highestprice: (a, b) => {\n    if (a.price > b.price) return -1;\n    if (a.price < b.price) return 1;\n    return 0;\n  },\n  discount: (a,b) => {\n    if (a.discount > b.discount) return 1;\n    return 0;\n  }\n};\n\nexport const fetchProducts = (filters, sortBy, search, callback) => dispatch => {\n  return axios\n    .get(productsAPI)\n    .then(res => {\n      var products  = res.data;\n\n      if (!!filters && filters.length > 0) {\n        products = products.filter(p => p.price <= filters  );\n      }\n\n      if (!!sortBy) {\n        products = products.sort(compare[sortBy]);\n      }\n\n      if(!!search){\n        products = products.filter(p => Object.keys(p).some(key => p[key].toString().toLowerCase().includes(search.toLowerCase())));\n      }\n\n      if (!!callback) {\n        callback();\n      }\n\n      return dispatch({\n        type: FETCH_PRODUCTS,\n        payload: products\n      });\n    })\n    .catch(err => {\n      console.log('Could not fetch products. Try again later.');\n    });\n};\n"]},"metadata":{},"sourceType":"module"}